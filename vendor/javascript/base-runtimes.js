// base-runtimes@0.2.0 downloaded from https://ga.jspm.io/npm:base-runtimes@0.2.0/index.js

import e from"lazy-cache";import t from"extend-shallow";import n from"is-valid-app";import i from"log-utils";import s from"micromatch";import r from"time-diff";var a={};var o=e(null);var l=null;require=o;t;n;i;s;r;require=l;o.colors=o.log.colors;o.timestamp=function(){var e=[].slice.call(arguments);e.unshift(o.log.timestamp);console.error.apply(console,e)};a=o;var m=a;var u={};var c=m;u=function(e){e=e||{};return function baseRuntimes(e){if(c.isValid(e,"base-runtimes")){var t=new c.Time;var n=c.log;this.on("starting",(function(i){var s={app:i};s.key=toKey(namespace(i));s.event="starting";t.start(s.key);s.time="";s.isBuild=true;s.isSilent=silent(e,i,null);e.hasListeners("build")?e.emit("build",s.event,s):e.base.hasListeners("build")?e.base.emit("build",s.event,s):s.isSilent||console.error(n.timestamp,s.event,s.key,n.red(s.time))}));this.on("finished",(function(i,s){var r={app:i};r.key=toKey(namespace(i));r.time=t.end(r.key);r.event="finished";r.isBuild=true;r.isSilent=silent(e,i,null);e.hasListeners("build")?e.emit("build",r.event,r):e.base.hasListeners("build")?e.base.emit("build",r.event,r):r.isSilent||console.error(n.timestamp,r.event,r.key,n.red(r.time))}));this.on("task:starting",(function(i){i.key=toKey(namespace(e),name(i)+" task");t.start("task:"+i.key);i.event="starting";i.time="";i.isTask=true;i.isSilent=silent(e,null,i);e.hasListeners("task")?e.emit("task",i.event,i):e.base.hasListeners("task")?e.base.emit("task",i.event,i):i.isSilent||console.error(n.timestamp,i.event,i.key,n.red(i.time))}));this.on("task:finished",(function(i){i.key=toKey(namespace(e),name(i)+" task");i.time=t.end("task:"+i.key);i.event="finished";i.isTask=true;i.isSilent=silent(e,null,i);e.hasListeners("task")?e.emit("task",i.event,i):e.base.hasListeners("task")?e.base.emit("task",i.event,i):i.isSilent||console.error(n.timestamp,i.event,i.key,n.red(i.time))}));return baseRuntimes}function silent(e,t,n){var i=c.extend({},e.base.options,e.options);t&&t.options&&(i=c.extend({},i,t.options));n&&n.options&&(i=c.extend({},i,n.options));var s=i.verbose;var r=i.silent;if("function"===typeof s)return s(e,t,n);if(true===s)return false;if(n&&"tasks"===s)return false;if(t&&"build"===s)return false;if("function"===typeof r)return r(e,t,n);"string"===typeof r&&(r=[r]);return!!(t&&Array.isArray(r)&&isMatch(r,t.alias))||(!!(n&&Array.isArray(r)&&isMatch(r,n.name))||(true===r||void 0))}function name(e){return e.name||""}function namespace(e){return e.env?e.env.namespace:e.namespace||e._name}function toKey(e,t){var n="";e&&(e=formatNamespace(e));e&&t?n=c.colors.bold(c.colors.cyan(e))+":"+c.colors.yellow(t):e?n=c.colors.bold(c.colors.cyan(e)):t&&(n=c.colors.cyan(t));return n}}};function isMatch(e,t){return 0!==c.mm(t,e).length}function formatNamespace(e){if(0===e.indexOf("default."))return e.slice("default.".length);var t=e.split(".");var n=t.length;var i=-1;var s=[];while(++i<n){var r=t[i+1];var a=t[i];r&&r===a||s.push(a)}return s.join(".")}var f=u;export default f;

