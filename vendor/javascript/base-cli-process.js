// base-cli-process@0.1.19 downloaded from https://ga.jspm.io/npm:base-cli-process@0.1.19/index.js

import e from"assert";import r from"debug";import t from"export-files";import i from"os";import a from"path";import s from"util";import o from"lazy-cache";import n from"base-cli";import c from"base-cli-schema";import l from"base-cwd";import p from"base-config-process";import u from"base-option";import m from"base-pkg";import f from"arrayify-compact";import g from"arr-union";import v from"fs-exists-sync";import b from"is-valid-app";import d from"kind-of";import h from"log-utils";import y from"mixin-deep";import k from"object.pick";import P from"union-value";var O={};O=t(new URL(import.meta.url.slice(0,import.meta.url.lastIndexOf("/"))).pathname);var w=O;var j={};var z=i;var x=a;var U=s;var A=o(null);var R=null;require=A;n;c;l;p;u;m;f;g;v;b;d;h;y;k;P;require=R;A.colors=A.log.colors;A.magenta=A.colors.magenta;A.cyan=A.colors.cyan;A.assertPlugins=function(e,r){switch(r){case"pkg":case"config":e.assertPlugin("base-pkg");break;case"option":case"options":e.assertPlugin("base-option");break;case"task":case"tasks":e.assertPlugin("base-task");break;case"helper":case"helpers":case"asyncHelper":case"asyncHelpers":case"engine":case"engines":e.assertPlugin("templates");break;case"plugin":case"plugins":e.assertPlugin("base-pipeline");break;case"globals":case"store":e.assertPlugin("base-store");break;case"data":e.assertPlugin("base-data:cache.data");break}};A.formatValue=function(e){return A.cyan(U.inspect(e,null,10))};A.homeRelative=function(e){e=x.relative(z.homedir(),x.resolve(e));return x.normalize(e)};A.timestamp=function(){var e=[].slice.call(arguments);e.unshift(A.log.timestamp);console.log.apply(console,e)};A.stripQuotes=function(e){return e.replace(/^['"]|['"]$/g,"")};A.show=function(e){return A.isObject(e)&&true===e.show};A.isObject=function(e){return"object"===A.typeOf(e)};A.isString=function(e){return e&&"string"===typeof e};A.unionify=function(e){return A.arrayify(A.arrUnion.apply(null,arguments))};j=A;var q=j;var H={};var L=e;var V=r("base:cli:process");var E=w;var I=q;H=function(e){e=e||{};return function(r,t){if(I.isValid(r,"base-cli-process")){V("initializing <%s>, called from <%s>",new URL(import.meta.url).pathname,(void 0).id);r.use(assertPlugin);var i=createOpts(r,e);var a;initPlugins(this,i);Object.defineProperty(this.cli,"schema",{cliurable:true,enumerable:true,set:function(e){a=e},get:function(){return a||I.schema(r,createOpts(r,e))}});for(var s in E){V('mapping field "%s"',s);r.cli.map(s,E[s](r,t,i))}var o=this.cli.process;this.cli.process=function(t,i){V("normalizing argv object",t);var a={sortArrays:false,omitEmpty:true};var s=["get","set","toc","layout","options","data","plugins","related","reflinks","init","run","tasks"];var n=createOpts(r,e,a);var c=sortObject(this.schema.normalize(t,n),s);V("processing normalized argv",c);o.call(this,c,(function(e){if(e)return i(e);i(null,c)}))}}}};function initPlugins(e,r){e.use(I.cwd());"undefined"===typeof e.option&&e.use(I.option(r));"undefined"===typeof e.pkg&&e.use(I.pkg(r));"undefined"===typeof e.config&&e.use(I.config(r));"undefined"===typeof e.cli&&e.use(I.cli(r))}function sortObject(e,r){if(Array.isArray(r)&&r.length){r=I.arrUnion(r,Object.keys(e));var t=r.length,i=-1;var a={};while(++i<t){var s=r[i];e.hasOwnProperty(s)&&(a[s]=e[s])}return a}}function createOpts(e,r,t){"undefined"!==typeof t&&(r=I.merge({},t,r));var i=I.merge({},r,e.options);return i.schema?I.merge({},i,i.schema):i}function assertPlugin(e){e.define("assertPlugin",(function(r){L(e.registered.hasOwnProperty(r))}))}var Q=H;export default Q;

