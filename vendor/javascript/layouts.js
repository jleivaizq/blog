// layouts@0.11.0 downloaded from https://ga.jspm.io/npm:layouts@0.11.0/index.js

import r from"path";import t from"lazy-cache";import e from"falsey";import n from"delimiter-regex";import o from"get-view";var i={};var a=t(null);var u=null;require=a;e;n;o;require=u;i=a;var f=i;var s={};var c=r;var l=f;s=renderLayouts;var y={};function renderLayouts(r,t,e,n,o){isBuffer(r)&&(r=String(r));if("string"!==typeof r)throw new TypeError("expected content to be a string.");if("string"!==typeof t)throw new TypeError("expected layout name to be a string.");if("function"===typeof n){o=n;n={}}n=n||{};var i={};var a=0;var u;var f={options:{},history:[]};t=assertLayout(t,n.defaultLayout);while(t&&u!==t&&(i=l.getView(t,e))){u=t;var s=n.layoutDelims;var c={};var y=n.tag||"body";c[y]=r;var m=new Layout({name:t,layout:i,before:r,depth:a++});var p=makeDelimiterRegex(s,y);var v=String(i.content);if(!p.test(v))throw error(p,t,y);r=wrapLayout(v,c,p,t,y);m.after=r;"function"===typeof o&&o(m,f,a);f.history.push(m);t=assertLayout(i.layout,n.defaultLayout)}if("string"===typeof t&&u!==t)throw new Error('could not find layout "'+t+'"');f.options=n;f.result=r;return f}function Layout(r){this.layout=r.layout;this.layout.name=r.name;this.before=r.before;this.depth=r.depth;return this}function assertLayout(r,t){return false===r||r&&l.isFalsey(r)?null:r&&true!==r?r:t||null}function wrapLayout(r,t,e,n,o){return r.replace(e,(function(r,i){var a=t[i.trim()];if("undefined"===typeof a)throw error(e,n,o);return a}))}function makeDelimiterRegex(r,t){r||(r=makeTag(t,["{%","%}"]));if(r instanceof RegExp)return r;var e=r+"";return y.hasOwnProperty(e)?y[e]:"string"===typeof r?new RegExp(r,"g"):y[e]=l.delims(r)}function makeTag(r,t){return t[0].trim()+" ("+String(r).trim()+") "+t[1].trim()}function error(r,t,e){var n=matchDelims(r,e);return new Error('cannot find "'+n+'" in "'+t+'"')}var m={"{%=":function(r){return"{%= "+r+" %}"},"{%-":function(r){return"{%- "+r+" %}"},"{%":function(r){return"{% "+r+" %}"},"{{":function(r){return"{{ "+r+" }}"},"<%":function(r){return"<% "+r+" %>"},"<%=":function(r){return"<%= "+r+" %>"},"<%-":function(r){return"<%- "+r+" %>"}};function matchDelims(r,t){var e=r.source.slice(0,4);/[\\]/.test(e.charAt(0))&&(e=e.slice(1));e=/[-=]/.test(e.charAt(2))?e.slice(0,3):e.slice(0,2);return m[e](t)}function isBuffer(r){return!(!r||!r.constructor||"function"!==typeof r.constructor.isBuffer)&&r.constructor.isBuffer(r)}var p=s;export default p;

